#include "sysFlash.h"#include "gd32e10x.h"#define FMC_PAGE_SIZE				((uint16_t)0x400U)/*	4字节读取*/uint32_t Flash_ReadWord(uint32_t faddr){	return *(uint32_t*)faddr;}/*	Flash擦除页*/void Fmc_ErasePages(uint32_t address,u16_t PageNum){	fmc_unlock();	  fmc_flag_clear(FMC_FLAG_END | FMC_FLAG_WPERR | FMC_FLAG_PGAERR | FMC_FLAG_PGERR);  	for(u16_t i = 0; i < PageNum; i++)	{   fmc_page_erase(address + (FMC_PAGE_SIZE * i));   fmc_flag_clear(FMC_FLAG_END | FMC_FLAG_WPERR | FMC_FLAG_PGAERR | FMC_FLAG_PGERR);  }	fmc_lock();	}/*	内部flash写入*/void Fmc_WriteToFlash(uint32_t address,u8 *InBuf, u16 len){	//写之前要先擦除页 不然写不进去	u8 pageNum = len % FMC_PAGE_SIZE > 0 ? len / FMC_PAGE_SIZE + 1:len / FMC_PAGE_SIZE;	Fmc_ErasePages(address,pageNum);	fmc_unlock();	fmc_flag_clear(FMC_FLAG_END | FMC_FLAG_WPERR | FMC_FLAG_PGAERR | FMC_FLAG_PGERR );		for(u16 i = 0; i < len; i += 4)	{		fmc_word_program(address,*(uint32_t*)InBuf);		__nop();__nop();__nop();__nop();		address += 4;		InBuf += 4;		}	fmc_lock();}/*	内部flash 读取*/void Fmc_ReadToFlash(uint32_t address,uint32_t *InBuf, u16 len){	for(u16 i = 0; i < len; i++)	{		InBuf[i] = Flash_ReadWord(address);		__nop();		address += 4;	}}